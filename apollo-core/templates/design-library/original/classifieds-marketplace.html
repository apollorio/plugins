<!DOCTYPE html>
<!--
================================================================================
APOLLO TEMPLATE: CLASSIFICADOS / MARKETPLACE
================================================================================
PHP: templates/shortcode-classifieds.php | Shortcode: [apollo_classifieds]

BASED ON: WP Adverts integration
PURPOSE: Marketplace for event tickets, flatshares, equipment, services

@BLOCKS: HEADER, CURRENCY_WIDGET, FILTERS, ADVERT_GRID, SAFETY_BANNER
@WIDGETS: CURRENCY_CONVERTER (USD/BRL), CATEGORY_FILTER, SEARCH
@CARDS: ADVERT_CARD (author, event link, image, price, actions)
@LAYOUTS: Full-width with sidebar filters (responsive)

PHP VARS: 
  - $adverts_query (WP_Query from wpadverts)
  - $current_user (wp_get_current_user())
  - $categories (array: tickets, bedroom, equipment, services)
  - $exchange_rate (USD to BRL rate from API)

CATEGORIES:
  - üé´ Tickets (Ingressos)
  - üè† Bedroom / Flatshare (Quarto / Rep√∫blica)
  - üéõÔ∏è Equipment (Equipamentos)
  - üéß Services (Servi√ßos)

SAFETY: Apollo::rio is a connector only - no responsibility for transactions

CLASSES UNI.CSS:
  .ap-classifieds, .ap-classifieds-header, .ap-classifieds-grid
  .ap-advert-card, .ap-advert-image, .ap-advert-info, .ap-advert-footer
  .ap-currency-widget, .ap-currency-display
  .ap-safety-banner
  .ap-filter-sidebar, .ap-filter-group
================================================================================
-->
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Classificado::rio - Apollo Marketplace</title>

  <!-- UNI.CSS Global Design System -->
  <link rel="stylesheet" href="https://assets.apollo.rio.br/uni.css">
  <script src="https://assets.apollo.rio.br/base.js" defer></script>
  
  <!-- RemixIcon -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.7.0/fonts/remixicon.css" rel="stylesheet">
</head>

<body class="ap-classifieds-body">
  <!-- Currency Converter Background Widget (Floating) -->
  <div class="ap-currency-float" id="currencyWidget">
    <div class="ap-currency-float-inner">
      <div class="ap-currency-rate">
        <span class="ap-currency-flag">üá∫üá∏</span>
        <span class="ap-currency-value" id="usdValue">1.00</span>
        <span class="ap-currency-code">USD</span>
        <i class="ri-arrow-right-line"></i>
        <span class="ap-currency-flag">üáßüá∑</span>
        <span class="ap-currency-value ap-currency-value-highlight" id="brlValue">5.80</span>
        <span class="ap-currency-code">BRL</span>
      </div>
      <button class="ap-currency-toggle" id="currencyToggle" data-ap-tooltip="Abrir conversor">
        <i class="ri-exchange-dollar-line"></i>
      </button>
    </div>
    
    <!-- Expanded Converter Panel -->
    <div class="ap-currency-panel" id="currencyPanel">
      <div class="ap-currency-panel-header">
        <h4><i class="ri-exchange-funds-line"></i> Conversor USD ‚Üî BRL</h4>
        <button class="ap-currency-close" id="currencyClose">
          <i class="ri-close-line"></i>
        </button>
      </div>
      <div class="ap-currency-panel-body">
        <div class="ap-currency-input-group">
          <label>USD (D√≥lar)</label>
          <input type="number" id="inputUSD" value="1" min="0" step="0.01">
        </div>
        <button class="ap-currency-swap" id="currencySwap" data-ap-tooltip="Inverter">
          <i class="ri-arrow-up-down-line"></i>
        </button>
        <div class="ap-currency-input-group">
          <label>BRL (Real)</label>
          <input type="number" id="inputBRL" value="5.80" min="0" step="0.01">
        </div>
      </div>
      <div class="ap-currency-panel-footer">
        <span class="ap-currency-update" id="currencyUpdate">
          <i class="ri-time-line"></i> Atualizado agora
        </span>
        <span class="ap-currency-source">Via ExchangeRate API</span>
      </div>
    </div>
  </div>

  <div class="ap-classifieds">
    <!-- ====================================================================
         [HEADER] Classifieds Header with Brand & Safety Warning
         ==================================================================== -->
    <header class="ap-classifieds-header">
      <div class="ap-classifieds-brand">
        <div class="ap-brand-icon">
          <i class="ri-price-tag-3-fill"></i>
        </div>
        <div class="ap-brand-text">
          <h1 class="ap-brand-title">Classificado<span class="ap-brand-accent">::</span>rio</h1>
          <p class="ap-brand-subtitle">Marketplace da Comunidade Apollo</p>
        </div>
      </div>
      
      <!-- Safety Warning Banner -->
      <div class="ap-safety-banner">
        <div class="ap-safety-icon">
          <i class="ri-shield-check-line"></i>
        </div>
        <div class="ap-safety-text">
          Apollo::rio facilita conex√µes e pontes, mas <mark>n√£o vendemos</mark> e 
          <mark>nem nos responsabilizamos</mark> por negocia√ß√µes e contato 
          <mark>de nenhuma transa√ß√£o iniciada aqui</mark>!
        </div>
        <a href="https://dicas.apollo.rio.br" target="_blank" class="ap-safety-link" data-ap-tooltip="Dicas de seguran√ßa">
          <i class="ri-external-link-line"></i> Dicas de Seguran√ßa
        </a>
      </div>
    </header>

    <!-- ====================================================================
         [FILTERS] Search & Category Filters
         ==================================================================== -->
    <div class="ap-classifieds-filters">
      <!-- Search Bar -->
      <div class="ap-classifieds-search">
        <div class="ap-search-form ap-search-lg">
          <i class="ri-search-line"></i>
          <input type="text" id="advertSearch" class="ap-search-input" placeholder="Buscar ingressos, quartos, equipamentos...">
        </div>
      </div>

      <!-- Category Tabs -->
      <div class="ap-filter-tabs ap-filter-tabs-pills">
        <button class="ap-tab-pill active" data-filter="all" data-ap-tooltip="Mostrar todos os an√∫ncios">
          <i class="ri-apps-line"></i> Todos
        </button>
        <button class="ap-tab-pill" data-filter="tickets" data-ap-tooltip="Ingressos para eventos">
          <i class="ri-ticket-2-line"></i> Ingressos
        </button>
        <button class="ap-tab-pill" data-filter="bedroom" data-ap-tooltip="Quartos e rep√∫blicas">
          <i class="ri-home-heart-line"></i> Quartos
        </button>
        <button class="ap-tab-pill" data-filter="equipment" data-ap-tooltip="Equipamentos de som e luz">
          <i class="ri-sound-module-line"></i> Equipamentos
        </button>
        <button class="ap-tab-pill" data-filter="services" data-ap-tooltip="Servi√ßos profissionais">
          <i class="ri-service-line"></i> Servi√ßos
        </button>
      </div>

      <!-- Sort & View Options -->
      <div class="ap-classifieds-options">
        <select class="ap-select-mini" id="advertSort">
          <option value="recent">Mais Recentes</option>
          <option value="price-low">Menor Pre√ßo</option>
          <option value="price-high">Maior Pre√ßo</option>
          <option value="popular">Mais Vistos</option>
        </select>
        <div class="ap-view-toggle">
          <button class="ap-btn-icon-sm active" data-view="grid" data-ap-tooltip="Visualiza√ß√£o em grade">
            <i class="ri-grid-fill"></i>
          </button>
          <button class="ap-btn-icon-sm" data-view="list" data-ap-tooltip="Visualiza√ß√£o em lista">
            <i class="ri-list-check"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- ====================================================================
         [GRID] Adverts Grid
         ==================================================================== -->
    <main class="ap-adverts-grid" id="advertsGrid">
      
      <!-- @LOOP: ADVERTS START -->
      <!-- @PHP: foreach($adverts_query->posts as $advert) -->
      
      <!-- Advert Card 1: Ticket -->
      <a href="#" class="ap-advert-card" data-category="tickets" data-price="150">
        <div class="ap-advert-body">
          <!-- Top: Author & Event Info -->
          <div class="ap-advert-top">
            <div class="ap-advert-author">
              <!-- @PHP: echo get_avatar($advert->post_author, 40) -->
              <div class="ap-avatar ap-avatar-sm" style="background: linear-gradient(135deg, #6366f1, #8b5cf6);">
                <span>JP</span>
              </div>
              <div class="ap-advert-author-info">
                <span class="ap-advert-label">An√∫ncio de</span>
                <!-- @PHP: echo esc_html(get_the_author_meta('display_name', $advert->post_author)) -->
                <span class="ap-advert-author-name">Jo√£o Paulo</span>
              </div>
            </div>
            <div class="ap-advert-event">
              <div class="ap-advert-event-info">
                <!-- @PHP: echo esc_html($event->post_title) -->
                <span class="ap-advert-event-title">BLOCO DO CAOS</span>
                <!-- @PHP: echo esc_html(date('d/m', strtotime($event_date))) . ' @ ' . $venue_name -->
                <span class="ap-advert-event-meta">15/02 @ Circo Voador</span>
              </div>
            </div>
          </div>
          
          <!-- Image -->
          <div class="ap-advert-image">
            <!-- @PHP: echo get_the_post_thumbnail($advert->ID, 'medium') -->
            <img src="https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=600" alt="Evento">
            <span class="ap-advert-category-badge">
              <i class="ri-ticket-2-fill"></i> Ingresso
            </span>
          </div>
        </div>
        
        <!-- Price & Quantity Info -->
        <div class="ap-advert-info">
          <div class="ap-advert-quantity">
            <i class="ri-ticket-line"></i>
            <span><b>2x</b> ingressos</span>
          </div>
          <div class="ap-advert-price">
            <span class="ap-price-currency">R$</span>
            <span class="ap-price-value">150</span>
            <span class="ap-price-unit">/unid</span>
          </div>
        </div>
        
        <!-- Footer Actions -->
        <div class="ap-advert-footer">
          <button class="ap-advert-btn ap-advert-btn-secondary" data-ap-tooltip="Ver perfil do vendedor">
            <i class="ri-user-search-line"></i> Investigar
          </button>
          <button class="ap-advert-btn ap-advert-btn-primary" data-ap-tooltip="Iniciar conversa">
            <i class="ri-chat-3-line"></i> Chat
          </button>
        </div>
      </a>

      <!-- Advert Card 2: Bedroom -->
      <a href="#" class="ap-advert-card" data-category="bedroom" data-price="1200">
        <div class="ap-advert-body">
          <div class="ap-advert-top">
            <div class="ap-advert-author">
              <div class="ap-avatar ap-avatar-sm" style="background: linear-gradient(135deg, #ec4899, #f472b6);">
                <span>ML</span>
              </div>
              <div class="ap-advert-author-info">
                <span class="ap-advert-label">An√∫ncio de</span>
                <span class="ap-advert-author-name">Maria Luiza</span>
              </div>
            </div>
            <div class="ap-advert-event">
              <div class="ap-advert-event-info">
                <span class="ap-advert-event-title">Rep√∫blica Lapa</span>
                <span class="ap-advert-event-meta">Centro, Rio de Janeiro</span>
              </div>
            </div>
          </div>
          
          <div class="ap-advert-image">
            <img src="https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=600" alt="Quarto">
            <span class="ap-advert-category-badge ap-badge-bedroom">
              <i class="ri-home-heart-fill"></i> Quarto
            </span>
          </div>
        </div>
        
        <div class="ap-advert-info">
          <div class="ap-advert-quantity">
            <i class="ri-door-open-line"></i>
            <span><b>1</b> quarto dispon√≠vel</span>
          </div>
          <div class="ap-advert-price">
            <span class="ap-price-currency">R$</span>
            <span class="ap-price-value">1.200</span>
            <span class="ap-price-unit">/m√™s</span>
          </div>
        </div>
        
        <div class="ap-advert-footer">
          <button class="ap-advert-btn ap-advert-btn-secondary" data-ap-tooltip="Ver perfil do anunciante">
            <i class="ri-user-search-line"></i> Investigar
          </button>
          <button class="ap-advert-btn ap-advert-btn-primary" data-ap-tooltip="Iniciar conversa">
            <i class="ri-chat-3-line"></i> Chat
          </button>
        </div>
      </a>

      <!-- Advert Card 3: Equipment -->
      <a href="#" class="ap-advert-card" data-category="equipment" data-price="350">
        <div class="ap-advert-body">
          <div class="ap-advert-top">
            <div class="ap-advert-author">
              <div class="ap-avatar ap-avatar-sm" style="background: linear-gradient(135deg, #22c55e, #4ade80);">
                <span>DJ</span>
              </div>
              <div class="ap-advert-author-info">
                <span class="ap-advert-label">An√∫ncio de</span>
                <span class="ap-advert-author-name">DJ Thunder</span>
              </div>
            </div>
            <div class="ap-advert-event">
              <div class="ap-advert-event-info">
                <span class="ap-advert-event-title">Pioneer DDJ-400</span>
                <span class="ap-advert-event-meta">Seminovo, 1 ano de uso</span>
              </div>
            </div>
          </div>
          
          <div class="ap-advert-image">
            <img src="https://images.unsplash.com/photo-1571330735066-03aaa9429d89?w=600" alt="Equipamento DJ">
            <span class="ap-advert-category-badge ap-badge-equipment">
              <i class="ri-sound-module-fill"></i> Equipamento
            </span>
          </div>
        </div>
        
        <div class="ap-advert-info">
          <div class="ap-advert-quantity">
            <i class="ri-box-3-line"></i>
            <span>Venda ou <b>Aluguel</b></span>
          </div>
          <div class="ap-advert-price">
            <span class="ap-price-currency">R$</span>
            <span class="ap-price-value">350</span>
            <span class="ap-price-unit">/dia</span>
          </div>
        </div>
        
        <div class="ap-advert-footer">
          <button class="ap-advert-btn ap-advert-btn-secondary" data-ap-tooltip="Ver perfil do vendedor">
            <i class="ri-user-search-line"></i> Investigar
          </button>
          <button class="ap-advert-btn ap-advert-btn-primary" data-ap-tooltip="Iniciar conversa">
            <i class="ri-chat-3-line"></i> Chat
          </button>
        </div>
      </a>

      <!-- Advert Card 4: Service -->
      <a href="#" class="ap-advert-card" data-category="services" data-price="500">
        <div class="ap-advert-body">
          <div class="ap-advert-top">
            <div class="ap-advert-author">
              <div class="ap-avatar ap-avatar-sm" style="background: linear-gradient(135deg, #f97316, #fb923c);">
                <span>FS</span>
              </div>
              <div class="ap-advert-author-info">
                <span class="ap-advert-label">An√∫ncio de</span>
                <span class="ap-advert-author-name">Felipe Studio</span>
              </div>
            </div>
            <div class="ap-advert-event">
              <div class="ap-advert-event-info">
                <span class="ap-advert-event-title">Fotografia de Eventos</span>
                <span class="ap-advert-event-meta">Profissional, 5 anos exp.</span>
              </div>
            </div>
          </div>
          
          <div class="ap-advert-image">
            <img src="https://images.unsplash.com/photo-1516035069371-29a1b244cc32?w=600" alt="Fotografia">
            <span class="ap-advert-category-badge ap-badge-service">
              <i class="ri-camera-lens-fill"></i> Servi√ßo
            </span>
          </div>
        </div>
        
        <div class="ap-advert-info">
          <div class="ap-advert-quantity">
            <i class="ri-camera-line"></i>
            <span>Cobertura <b>completa</b></span>
          </div>
          <div class="ap-advert-price">
            <span class="ap-price-currency">R$</span>
            <span class="ap-price-value">500</span>
            <span class="ap-price-unit">/evento</span>
          </div>
        </div>
        
        <div class="ap-advert-footer">
          <button class="ap-advert-btn ap-advert-btn-secondary" data-ap-tooltip="Ver portf√≥lio">
            <i class="ri-user-search-line"></i> Investigar
          </button>
          <button class="ap-advert-btn ap-advert-btn-primary" data-ap-tooltip="Solicitar or√ßamento">
            <i class="ri-chat-3-line"></i> Chat
          </button>
        </div>
      </a>

      <!-- Advert Card 5: Another Ticket -->
      <a href="#" class="ap-advert-card" data-category="tickets" data-price="80">
        <div class="ap-advert-body">
          <div class="ap-advert-top">
            <div class="ap-advert-author">
              <div class="ap-avatar ap-avatar-sm" style="background: linear-gradient(135deg, #3b82f6, #60a5fa);">
                <span>AC</span>
              </div>
              <div class="ap-advert-author-info">
                <span class="ap-advert-label">An√∫ncio de</span>
                <span class="ap-advert-author-name">Ana Clara</span>
              </div>
            </div>
            <div class="ap-advert-event">
              <div class="ap-advert-event-info">
                <span class="ap-advert-event-title">WARUNG TOUR</span>
                <span class="ap-advert-event-meta">22/02 @ Via Parque</span>
              </div>
            </div>
          </div>
          
          <div class="ap-advert-image">
            <img src="https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=600" alt="Evento">
            <span class="ap-advert-category-badge">
              <i class="ri-ticket-2-fill"></i> Ingresso
            </span>
          </div>
        </div>
        
        <div class="ap-advert-info">
          <div class="ap-advert-quantity">
            <i class="ri-ticket-line"></i>
            <span><b>1x</b> ingresso (meia)</span>
          </div>
          <div class="ap-advert-price">
            <span class="ap-price-currency">R$</span>
            <span class="ap-price-value">80</span>
            <span class="ap-price-unit">/unid</span>
          </div>
        </div>
        
        <div class="ap-advert-footer">
          <button class="ap-advert-btn ap-advert-btn-secondary" data-ap-tooltip="Ver perfil do vendedor">
            <i class="ri-user-search-line"></i> Investigar
          </button>
          <button class="ap-advert-btn ap-advert-btn-primary" data-ap-tooltip="Iniciar conversa">
            <i class="ri-chat-3-line"></i> Chat
          </button>
        </div>
      </a>

      <!-- Advert Card 6: Bedroom -->
      <a href="#" class="ap-advert-card" data-category="bedroom" data-price="900">
        <div class="ap-advert-body">
          <div class="ap-advert-top">
            <div class="ap-advert-author">
              <div class="ap-avatar ap-avatar-sm" style="background: linear-gradient(135deg, #a855f7, #c084fc);">
                <span>RS</span>
              </div>
              <div class="ap-advert-author-info">
                <span class="ap-advert-label">An√∫ncio de</span>
                <span class="ap-advert-author-name">Rafael Santos</span>
              </div>
            </div>
            <div class="ap-advert-event">
              <div class="ap-advert-event-info">
                <span class="ap-advert-event-title">Quarto Botafogo</span>
                <span class="ap-advert-event-meta">Perto do metr√¥, mobiliado</span>
              </div>
            </div>
          </div>
          
          <div class="ap-advert-image">
            <img src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=600" alt="Quarto">
            <span class="ap-advert-category-badge ap-badge-bedroom">
              <i class="ri-home-heart-fill"></i> Quarto
            </span>
          </div>
        </div>
        
        <div class="ap-advert-info">
          <div class="ap-advert-quantity">
            <i class="ri-door-open-line"></i>
            <span><b>Suite</b> individual</span>
          </div>
          <div class="ap-advert-price">
            <span class="ap-price-currency">R$</span>
            <span class="ap-price-value">900</span>
            <span class="ap-price-unit">/m√™s</span>
          </div>
        </div>
        
        <div class="ap-advert-footer">
          <button class="ap-advert-btn ap-advert-btn-secondary" data-ap-tooltip="Ver perfil do anunciante">
            <i class="ri-user-search-line"></i> Investigar
          </button>
          <button class="ap-advert-btn ap-advert-btn-primary" data-ap-tooltip="Iniciar conversa">
            <i class="ri-chat-3-line"></i> Chat
          </button>
        </div>
      </a>

      <!-- @LOOP: ADVERTS END -->
    </main>

    <!-- ====================================================================
         [FOOTER] Load More & Create Advert
         ==================================================================== -->
    <footer class="ap-classifieds-footer">
      <button class="ap-btn ap-btn-outline" id="loadMore">
        <i class="ri-refresh-line"></i> Carregar Mais
      </button>
      <a href="/criar-anuncio" class="ap-btn ap-btn-primary">
        <i class="ri-add-circle-line"></i> Criar An√∫ncio
      </a>
    </footer>
  </div>

  <!-- ====================================================================
       [SCRIPTS] Classifieds JavaScript
       ==================================================================== -->
  <script>
  /**
   * APOLLO CLASSIFIEDS - JavaScript Controller
   * Handles currency conversion, filtering, search, and interactions
   */
  (function() {
    'use strict';

    // ========================================
    // CURRENCY CONVERTER (USD/BRL)
    // ========================================
    const currency = {
      rate: 5.80, // Default fallback rate
      lastUpdate: null,
      
      async fetchRate() {
        try {
          // Try multiple APIs for redundancy
          const apis = [
            'https://api.exchangerate.host/latest?base=USD&symbols=BRL',
            'https://api.frankfurter.app/latest?from=USD&to=BRL'
          ];
          
          for (const url of apis) {
            try {
              const res = await fetch(url, { cache: 'no-store' });
              const data = await res.json();
              
              if (data.rates?.BRL) {
                this.rate = data.rates.BRL;
                this.lastUpdate = new Date();
                return this.rate;
              }
            } catch (e) { continue; }
          }
        } catch (e) {
          console.warn('[Currency] Using fallback rate:', this.rate);
        }
        return this.rate;
      },
      
      usdToBrl(usd) {
        return (usd * this.rate).toFixed(2);
      },
      
      brlToUsd(brl) {
        return (brl / this.rate).toFixed(2);
      },
      
      updateDisplay() {
        const usdEl = document.getElementById('usdValue');
        const brlEl = document.getElementById('brlValue');
        const updateEl = document.getElementById('currencyUpdate');
        
        if (usdEl) usdEl.textContent = '1.00';
        if (brlEl) brlEl.textContent = this.rate.toFixed(2);
        
        if (updateEl && this.lastUpdate) {
          const mins = Math.floor((Date.now() - this.lastUpdate) / 60000);
          updateEl.innerHTML = `<i class="ri-time-line"></i> Atualizado ${mins < 1 ? 'agora' : `h√° ${mins}min`}`;
        }
      }
    };

    // Currency Widget Interactions
    const currencyToggle = document.getElementById('currencyToggle');
    const currencyPanel = document.getElementById('currencyPanel');
    const currencyClose = document.getElementById('currencyClose');
    const currencySwap = document.getElementById('currencySwap');
    const inputUSD = document.getElementById('inputUSD');
    const inputBRL = document.getElementById('inputBRL');
    
    currencyToggle?.addEventListener('click', () => {
      currencyPanel?.classList.toggle('open');
    });
    
    currencyClose?.addEventListener('click', () => {
      currencyPanel?.classList.remove('open');
    });
    
    inputUSD?.addEventListener('input', () => {
      const usd = parseFloat(inputUSD.value) || 0;
      inputBRL.value = currency.usdToBrl(usd);
    });
    
    inputBRL?.addEventListener('input', () => {
      const brl = parseFloat(inputBRL.value) || 0;
      inputUSD.value = currency.brlToUsd(brl);
    });
    
    currencySwap?.addEventListener('click', () => {
      const tempUSD = inputUSD.value;
      inputUSD.value = inputBRL.value;
      inputBRL.value = tempUSD;
    });

    // ========================================
    // FILTER & SEARCH
    // ========================================
    const filterPills = document.querySelectorAll('.ap-tab-pill');
    const advertCards = document.querySelectorAll('.ap-advert-card');
    const searchInput = document.getElementById('advertSearch');
    const sortSelect = document.getElementById('advertSort');
    
    let currentFilter = 'all';
    let currentSearch = '';
    
    function filterAdverts() {
      advertCards.forEach(card => {
        const category = card.dataset.category;
        const text = card.textContent.toLowerCase();
        
        const matchesFilter = currentFilter === 'all' || category === currentFilter;
        const matchesSearch = !currentSearch || text.includes(currentSearch.toLowerCase());
        
        card.style.display = (matchesFilter && matchesSearch) ? '' : 'none';
      });
      
      updateVisibleCount();
    }
    
    function updateVisibleCount() {
      const visible = document.querySelectorAll('.ap-advert-card[style=""], .ap-advert-card:not([style])').length;
      // Could update a counter element here
    }
    
    filterPills.forEach(pill => {
      pill.addEventListener('click', () => {
        filterPills.forEach(p => p.classList.remove('active'));
        pill.classList.add('active');
        currentFilter = pill.dataset.filter;
        filterAdverts();
      });
    });
    
    searchInput?.addEventListener('input', (e) => {
      currentSearch = e.target.value;
      filterAdverts();
    });
    
    sortSelect?.addEventListener('change', () => {
      const grid = document.getElementById('advertsGrid');
      const cards = [...grid.querySelectorAll('.ap-advert-card')];
      
      cards.sort((a, b) => {
        const priceA = parseInt(a.dataset.price) || 0;
        const priceB = parseInt(b.dataset.price) || 0;
        
        switch (sortSelect.value) {
          case 'price-low': return priceA - priceB;
          case 'price-high': return priceB - priceA;
          case 'recent': return 0; // Keep original order
          default: return 0;
        }
      });
      
      cards.forEach(card => grid.appendChild(card));
    });

    // ========================================
    // VIEW TOGGLE (Grid/List)
    // ========================================
    const viewButtons = document.querySelectorAll('[data-view]');
    const advertsGrid = document.getElementById('advertsGrid');
    
    viewButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        viewButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        const view = btn.dataset.view;
        advertsGrid?.classList.toggle('ap-adverts-list', view === 'list');
      });
    });

    // ========================================
    // INITIALIZATION
    // ========================================
    document.addEventListener('DOMContentLoaded', async () => {
      // Fetch current exchange rate
      await currency.fetchRate();
      currency.updateDisplay();
      
      // Update rate every 5 minutes
      setInterval(async () => {
        await currency.fetchRate();
        currency.updateDisplay();
      }, 300000);
      
      // Initialize tooltips if apolloTooltips exists
      if (window.apolloStats) {
        apolloStats.animateMiniStats(document);
      }
      
      console.log('[Apollo Classifieds] Initialized');
    });

  })();
  </script>
</body>
</html>

