<!-- REQUIRES: https://assets.apollo.rio.br/uni.css + https://assets.apollo.rio.br/base.js -->
<!--
  Component: block-slider-gallery-I0
  Type: I0 (First design variant)
  Description: Image slider/gallery for event pages
  Used in: Event single page, Local single page, DJ page
  
  IMPORTANT: All elements MUST have data-tooltip for accessibility and UX
  
  Placeholders:
  - {{slider_id}} - Unique ID for the slider
  - {{images}} - Array of images with url, alt, caption
  
  Features:
  - Touch/swipe support on mobile
  - Auto-advance every 5 seconds
  - Pause on hover
  - Dot navigation
  - Previous/Next buttons
-->

<div class="promo-gallery-slider" data-component="block-slider-gallery" data-type="I0" id="{{slider_id}}">
  
  <!-- Slider Track -->
  <div class="promo-track" id="promoTrack-{{slider_id}}" data-tooltip="Galeria de imagens">
    <template data-loop="{{images}}">
      <div class="promo-slide" data-index="{{index}}">
        <img src="{{image_url}}" alt="{{image_alt}}" loading="lazy" data-tooltip="{{image_caption}}">
        <template data-if="{{image_caption}}">
          <span class="promo-caption">{{image_caption}}</span>
        </template>
      </div>
    </template>
  </div>
  
  <!-- Navigation Controls -->
  <button class="promo-prev" id="promoPrev-{{slider_id}}" aria-label="Imagem anterior" data-tooltip="Anterior">
    <i class="ri-arrow-left-s-line"></i>
  </button>
  <button class="promo-next" id="promoNext-{{slider_id}}" aria-label="Próxima imagem" data-tooltip="Próxima">
    <i class="ri-arrow-right-s-line"></i>
  </button>
  
  <!-- Dots Navigation -->
  <div class="promo-dots" id="promoDots-{{slider_id}}">
    <template data-loop="{{images}}">
      <button class="promo-dot" data-index="{{index}}" aria-label="Ir para imagem {{index}}" data-tooltip="Imagem {{index}}"></button>
    </template>
  </div>
  
</div>

<style>
/* Promo Gallery Slider - Type I0 */
.promo-gallery-slider {
  position: relative;
  width: 100%;
  overflow: hidden;
  border-radius: 16px;
  background: #f1f5f9;
}

.promo-track {
  display: flex;
  transition: transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
  will-change: transform;
}

.promo-slide {
  flex: 0 0 100%;
  position: relative;
  aspect-ratio: 16/9;
}

.promo-slide img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.promo-caption {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 12px 16px;
  background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
  color: white;
  font-size: 12px;
  font-weight: 500;
}

/* Navigation Buttons */
.promo-prev,
.promo-next {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: 40px;
  height: 40px;
  background: rgba(255,255,255,0.9);
  backdrop-filter: blur(8px);
  border: none;
  border-radius: 50%;
  color: #0f172a;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  transition: all 0.2s ease;
  z-index: 10;
}

.promo-prev:hover,
.promo-next:hover {
  background: white;
  transform: translateY(-50%) scale(1.1);
}

.promo-prev {
  left: 12px;
}

.promo-next {
  right: 12px;
}

/* Dots Navigation */
.promo-dots {
  position: absolute;
  bottom: 12px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 6px;
  z-index: 10;
}

.promo-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: rgba(255,255,255,0.5);
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
}

.promo-dot:hover {
  background: rgba(255,255,255,0.8);
}

.promo-dot.active {
  background: white;
  width: 20px;
  border-radius: 4px;
}

/* Mobile Responsive */
@media (max-width: 640px) {
  .promo-prev,
  .promo-next {
    width: 32px;
    height: 32px;
    font-size: 16px;
  }
  
  .promo-prev {
    left: 8px;
  }
  
  .promo-next {
    right: 8px;
  }
}
</style>

<script>
(function() {
  const sliderId = '{{slider_id}}';
  const track = document.getElementById('promoTrack-' + sliderId);
  const prevBtn = document.getElementById('promoPrev-' + sliderId);
  const nextBtn = document.getElementById('promoNext-' + sliderId);
  const dots = document.querySelectorAll('#promoDots-' + sliderId + ' .promo-dot');
  
  if (!track || !prevBtn || !nextBtn) return;
  
  const slides = track.querySelectorAll('.promo-slide');
  let currentIndex = 0;
  const total = slides.length;
  
  function goToSlide(index) {
    if (index < 0) index = total - 1;
    if (index >= total) index = 0;
    
    currentIndex = index;
    track.style.transform = `translateX(-${currentIndex * 100}%)`;
    
    // Update dots
    dots.forEach((dot, i) => {
      dot.classList.toggle('active', i === currentIndex);
    });
  }
  
  prevBtn.addEventListener('click', () => goToSlide(currentIndex - 1));
  nextBtn.addEventListener('click', () => goToSlide(currentIndex + 1));
  
  dots.forEach((dot, i) => {
    dot.addEventListener('click', () => goToSlide(i));
  });
  
  // Initialize
  goToSlide(0);
  
  // Auto-advance (optional)
  let autoPlay = setInterval(() => goToSlide(currentIndex + 1), 5000);
  
  // Pause on hover
  track.addEventListener('mouseenter', () => clearInterval(autoPlay));
  track.addEventListener('mouseleave', () => {
    autoPlay = setInterval(() => goToSlide(currentIndex + 1), 5000);
  });
  
  // Touch/Swipe support
  let startX = 0;
  let isDragging = false;
  
  track.addEventListener('touchstart', (e) => {
    startX = e.touches[0].clientX;
    isDragging = true;
  });
  
  track.addEventListener('touchmove', (e) => {
    if (!isDragging) return;
    const diff = startX - e.touches[0].clientX;
    if (Math.abs(diff) > 50) {
      goToSlide(diff > 0 ? currentIndex + 1 : currentIndex - 1);
      isDragging = false;
    }
  });
  
  track.addEventListener('touchend', () => {
    isDragging = false;
  });
})();
</script>

