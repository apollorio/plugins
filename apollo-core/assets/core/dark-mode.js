(()=>{if(window.__apInitDM)return;window.__apInitDM=1;var d=document,w=window,b,ls;try{ls=w.localStorage}catch(e){}var T="theme",W=new WeakSet,E=new Set,C=new Set,dt=new Date,cat="all",q="",mn=["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],mm={jan:0,fev:1,mar:2,abr:3,mai:4,jun:5,jul:6,ago:7,set:8,out:9,nov:10,dez:11},clk=0,clkEl=0,menuBox=0,docClick=0,dateEl=0,pf=0;function themeInit(){if(!b)return;try{ls&&ls.getItem(T)==="dark"&&b.classList.add("dark-mode")}catch(e){}}function bindToggle(t){if(!t||W.has(t))return;W.add(t);t.addEventListener("click",function(){b.classList.toggle("dark-mode");try{ls&&ls.setItem(T,b.classList.contains("dark-mode")?"dark":"light")}catch(e){}},{passive:!0})}function ensureToggle(){var t=d.getElementById("darkModeToggle")||d.querySelector(".dark-mode-toggle");if(!t&&b){t=d.createElement("div");t.className="dark-mode-toggle";t.id="darkModeToggle";t.setAttribute("role","button");t.setAttribute("aria-label","Toggle dark mode");t.innerHTML='<i class="ri-sun-line"></i><i class="ri-moon-line"></i>';b.appendChild(t)}bindToggle(t)}function bindMenu(tr){if(!tr||W.has(tr))return;W.add(tr);var box=tr.parentElement||0;menuBox=box;tr.addEventListener("click",function(e){e.stopPropagation();box&&box.classList.toggle("open")},!1);if(!docClick){docClick=1;d.addEventListener("click",function(e){menuBox&&!menuBox.contains(e.target)&&menuBox.classList.remove("open")},!1)}}function clockTick(){if(!clkEl||!clkEl.isConnected)return;var n=new Date,h=("0"+n.getHours()).slice(-2),m=("0"+n.getMinutes()).slice(-2);clkEl.textContent=h+":"+m}function ensureClock(el){el&&(clkEl=el);if(clk||!clkEl)return;clockTick();clk=setInterval(clockTick,1e4)}function schedFilter(){if(pf)return;pf=1;requestAnimationFrame(function(){pf=0;filter()})}function filter(){var dm=dt.getMonth();E.forEach(function(e){if(!e.isConnected){E.delete(e);return}var c=e.dataset.category||"",ms=(e.dataset.monthStr||"").toLowerCase(),em=mm[ms],sd=em===dm,sc=cat==="all"||c===cat,ss=!q||e.textContent.toLowerCase().includes(q),sh=sd&&sc&&ss;if(sh){e.classList.remove("hidden");e.style.display="block"}else{e.classList.add("hidden");e.style.display="none"}})}function updDate(){if(dateEl&&dateEl.isConnected)dateEl.textContent=mn[dt.getMonth()]+" "+dt.getFullYear();schedFilter()}function bindPrev(el){if(!el||W.has(el))return;W.add(el);el.addEventListener("click",function(){dt.setMonth(dt.getMonth()-1);updDate()},{passive:!0})}function bindNext(el){if(!el||W.has(el))return;W.add(el);el.addEventListener("click",function(){dt.setMonth(dt.getMonth()+1);updDate()},{passive:!0})}function bindForm(el){if(!el||W.has(el))return;W.add(el);el.addEventListener("submit",function(e){e.preventDefault()},!1)}function bindInput(el){if(!el||W.has(el))return;W.add(el);q=(el.value||"").toLowerCase();el.addEventListener("input",function(){q=(el.value||"").toLowerCase();schedFilter()},{passive:!0})}function bindCat(btn){if(!btn||W.has(btn))return;W.add(btn);C.add(btn);btn.addEventListener("click",function(){C.forEach(function(x){x.isConnected?x.classList.remove("active"):C.delete(x)});btn.classList.add("active");cat=btn.dataset.slug||"all";schedFilter()},{passive:!0});btn.classList.contains("active")&&cat==="all"&&btn.dataset.slug&&(cat=btn.dataset.slug)}function addEvent(el){el&&E.add(el)}function scan(r){if(!r||r.nodeType!==1)return;var i,n;if(r.id==="darkModeToggle"||r.classList&&r.classList.contains("dark-mode-toggle"))bindToggle(r);if(r.id==="userMenuTrigger")bindMenu(r);if(r.id==="agoraH")ensureClock(r);if(r.classList&&r.classList.contains("event_listing"))addEvent(r);if(r.classList&&r.classList.contains("event-category"))bindCat(r);if(r.id==="dateDisplay"){dateEl=r;updDate()}if(r.id==="datePrev")bindPrev(r);if(r.id==="dateNext")bindNext(r);if(r.id==="eventSearchInput")bindInput(r);if(r.id==="eventSearchForm")bindForm(r);if(!r.querySelectorAll)return;n=r.querySelectorAll("#darkModeToggle,.dark-mode-toggle");for(i=0;i<n.length;i++)bindToggle(n[i]);n=r.querySelectorAll("#userMenuTrigger");for(i=0;i<n.length;i++)bindMenu(n[i]);n=r.querySelectorAll("#agoraH");for(i=0;i<n.length;i++)ensureClock(n[i]);n=r.querySelectorAll(".event_listing");for(i=0;i<n.length;i++)addEvent(n[i]);n=r.querySelectorAll(".event-category");for(i=0;i<n.length;i++)bindCat(n[i]);n=r.querySelectorAll("#dateDisplay");if(n.length){dateEl=n[0];updDate()}n=r.querySelectorAll("#datePrev");if(n.length)bindPrev(n[0]);n=r.querySelectorAll("#dateNext");if(n.length)bindNext(n[0]);n=r.querySelectorAll("#eventSearchInput");if(n.length)bindInput(n[0]);n=r.querySelectorAll("#eventSearchForm");if(n.length)bindForm(n[0])}var R=new Set,rs=0;function flush(){rs=0;R.forEach(scan);R.clear();ensureToggle();schedFilter()}function schedule(){if(rs)return;rs=1;requestAnimationFrame(flush)}function onMut(ms){for(var j=0;j<ms.length;j++){var a=ms[j].addedNodes;for(var k=0;k<a.length;k++)a[k].nodeType===1&&R.add(a[k])}schedule()}function start(){b=d.body;if(!b)return;themeInit();scan(b);ensureToggle();schedFilter();new MutationObserver(onMut).observe(d.documentElement,{childList:!0,subtree:!0})}d.readyState!=="loading"?start():d.addEventListener("DOMContentLoaded",start,{once:!0})})();
